const tracks = {
  "GBA Mario Circuit": {
    trackImage: "media/GBA_Mario_Circuit/image.png",
    trackType: "Runner/Bagger",
    strategyDescription:
      "Running: I suggest you to run that track if you start in 1st or even 2nd because it's one of the shortest tracks, meaning that you have low probabilities to take a blue shell or get hit by a shock. This should be an advantage to run it if you can take the 3 shroomless cuts. The 1st one is a bit hard but even if you fail it, it will remain faster than taking the main road.\n\nBagging: You can choose to bag this track and come back with items due to the cuts, it can be op if you manage to pull good items and keep your shrooms until lap 3. You should bag this track if you start in lower positions, you can also bag behind the line because there is an item box in front of the boost in the alternative path, thus giving you good items instantly.",
    shortcuts: [
      {
        text: "Take the alternative path and start a drift while taking the boost and then release it in the middle of the off road to pass the area and get back to the road.",
        video: "media/GBA_Mario_Circuit/nisc1.mp4",
        frame: "media/GBA_Mario_Circuit/nisc1.jpg",
      },
      {
        text: "Just release a drift to the right and you will get to the road.",
        video: "media/GBA_Mario_Circuit/nisc2.mp4",
        frame: "media/GBA_Mario_Circuit/nisc2.jpg",
      },
      {
        text: "Release a smt and hop, then you can cut a bit and take a better line that way at the end instead of taking the whole route.",
        video: "media/GBA_Mario_Circuit/nisc3.mp4",
        frame: "media/GBA_Mario_Circuit/nisc3.jpg",
      },
      {
        text: "",
        video: "media/GBA_Mario_Circuit/sc1.mp4",
        frame: "media/GBA_Mario_Circuit/sc1.jpg",
      },
      {
        text: "",
        video: "media/GBA_Mario_Circuit/sc2.mp4",
        frame: "media/GBA_Mario_Circuit/sc2.jpg",
      },
      {
        text: "",
        video: "media/GBA_Mario_Circuit/sc3.mp4",
        frame: "media/GBA_Mario_Circuit/sc3.jpg",
      },
    ],
    billSpots: [],
  },
  "GCN Dino Dino Jungle": {
    trackImage: "media/GCN_Dino_Dino_Jungle/image.png",
    trackType: "Runner/Bagger",
    strategyDescription:
      "Running: I suggest you to run that track if you start in 1st or even 2nd, there are multiple shroomless cuts here as well that can lead you to run well. There also is a cannon in a track meaning that if there is a blue shell you might be able to dodge it in time in the cannon therefore giving you more chances to run peacefully the track. However be careful of the shocks because getting target shock'd in the middle of the shortcut in the cave section is very awkward.\n\nBagging: Multiple paths on this track leading you to be able to bag properly, you can start bagging at 1st boxes already and then if you want to increase the bagging, take one of the purple routes to be even further from 1st and then getting good items such as pulling the shock. I recommend you to not bag too much though because it can be a bit hard to come back if you're left too far behind, you should at least start to come back like mid lap 2 because there are no cuts on this track therefore making it hard to come back. If you have a shock, the best way to play it would be to target shock 1st or the people leading in general while they take the cut in the cave because target shocking people here is excellent.",
    shortcuts: [
      {
        text: "This is the fastest path through that section. The easiest way to take it is to hop and after landing hop again to start a drift. This way you never slide out",
        video: "media/GCN_Dino_Dino_Jungle/nisc1.mp4",
        frame: "media/GCN_Dino_Dino_Jungle/nisc1.jpg",
      },
      {
        text: "Release a smt into the off road and hop out. Then take the rest of the shortcut.",
        video: "media/GCN_Dino_Dino_Jungle/nisc2.mp4",
        frame: "media/GCN_Dino_Dino_Jungle/nisc2.jpg",
      },
    ],
    billSpots: [
      {
        text: "+2 Seconds\n\nNot a very memorable spot and the bullet skips the shortcut but it's still very fast",
        video: "media/GCN_Dino_Dino_Jungle/billSpot1.mp4",
        frame: "media/GCN_Dino_Dino_Jungle/billSpot1.jpg",
      },
      {
        text: "+1 Second\n\nUse it at that turn before the big shortcut. It takes you to the end of the track",
        video: "media/GCN_Dino_Dino_Jungle/billSpot2.mp4",
        frame: "media/GCN_Dino_Dino_Jungle/billSpot2.jpg",
      },
    ],
  },
  "3DS Neo Bowser City": {
    trackImage: "media/3DS_Neo_Bowser_City/image.png",
    trackType: "Runner/Bagger",
    strategyDescription:
      "Running: If you decide to run you should be careful of the last jump because it's a common target shock place. Watch out who's standing in last, that way you can predict if it'll be a good shock or not. Only a few cuts in this track, meaning that you can run it and hold the 1st place if there's no blue or shock. You should always take the tightest lines to increase your lead and also back your items, there are a lot of walls and also tight turns giving you chances to back your items there and hope to hit the people behind you.\n\nBagging: If you want to bag on this track you should hold your dodges when there's no possibilities to cut because shocks are frequent on this map as it's a 1 minute and 45 second track. You can also bag for items like mega/star and shrooms to be able to come back quickly, the ending cut is also very op if you take it well with good items, that way you can easily come back to the good places. If you have a shock, you should try to target shock the people in 1st and if it's not possible because too much people are in dodging items, just try to not use it too late or not in the cannon to be able to come back.\n\nShroomless cut in red: not really that much of a cut but you should always go in the left path unless you're bagging lap 1/2 so you can be faster by taking the boosts. It is way faster than the main road even if you skip a box (it remains better to take this route in all cases)",
    shortcuts: [
      {
        text: "",
        video: "media/3DS_Neo_Bowser_City/sc1.mp4",
        frame: "media/3DS_Neo_Bowser_City/sc1.jpg",
      },
      {
        text: "",
        video: "media/3DS_Neo_Bowser_City/sc2.mp4",
        frame: "media/3DS_Neo_Bowser_City/sc2.jpg",
      },
    ],
    billSpots: [
      {
        text: "This is a bullet shortcut. Just hop and activate your bill before hitting the lava and if you took it well like in the image, your bill will cut that part, this is a very op cut so if you have a bill try to keep it until that strat unless you have to use it. You can easily come back to top placements with good items after that.",
        video: "media/3DS_Neo_Bowser_City/billSpot1.mp4",
        frame: "media/3DS_Neo_Bowser_City/billSpot1.jpg",
      },
    ],
  },
  "DS Delfino Square": {
    trackImage: "media/DS_Delfino_Square/image.png",
    trackType: "Runner/Bagger",
    strategyDescription:
      "Running: Mostly a running track so you should always try to run as it's a very short track with strats so you can easily take the lead if you know these cuts good enough. The 1st shroomless cut can be hard so if you don't feel like doing it in crucial places like lap 3, you should take the normal road and then access the 2nd shroomless cut which is easier. However, you also have less chances to take a blue than some other long maps.\n\nBagging: You can bag this track but you shouldn't wait too much to come back and not being left too far behind. If you're too far behind it's almost impossible to come back and end up in 1st. There is an alternative path at the beginning with a bridge section, you should go there if you want to bag at the beginning or on lap 2 because there's a double item box that can give you strong items. You can also decide to not take the cut at the end and go to the longer path because there's also a double item box there. For this route you should only do it on lap 1 because you would be left too far behind if you go for it at the end of lap 2.",
    shortcuts: [
      {
        text: "Can be hard depending on the way you take it, if you take it in a safe way (like in the video) it should be fine as there's a ramp but if you try to save time you could start a drift and not tricking on the ramp to gain time but it is more precise and way harder.",
        video: "media/DS_Delfino_Square/nisc1.mp4",
        frame: "media/DS_Delfino_Square/nisc1.jpg",
      },
      {
        text: "Just release a smt into the dark brown part and hop out to not touch any off-road (note that only the dark brown part is off-road, not the light brown part)",
        video: "media/DS_Delfino_Square/nisc2.mp4",
        frame: "media/DS_Delfino_Square/nisc2.jpg",
      },
    ],
    billSpots: [],
  },
  "GBA Luigi Circuit": {
    trackImage: "media/GBA_Luigi_Circuit/image.png",
    trackType: "Bagger",
    strategyDescription:
      "It's better to bag on this track. There are a lot of cuts like on gba mario circuit but this track is also way longer than mario circuit, thus there will often be shock(s) and blue shell(s) on this track making running complicated. You can still try to run but I don't recommend you to if you aren't fast enough or not sure that you can take proper lines on it.",
    shortcuts: [
      {
        text: "Hard one to take so I don't recommend it to try it on lap 3 unless you really need to come back. You should practice it in time trials to learn it properly because it's not the easiest cut, jumping over the water like that can seem easy but the cut is harder than what you think. Also, if you don't take that cut you won't lose a lot of time + you will get 2 items so it's always better to go on the normal road unless you're running.",
        video: "media/GBA_Luigi_Circuit/nisc1.mp4",
        frame: "media/GBA_Luigi_Circuit/nisc1.jpg",
      },
      {
        text: "Skips an item.",
        video: "media/GBA_Luigi_Circuit/sc1.mp4",
        frame: "media/GBA_Luigi_Circuit/sc1.jpg",
      },
      {
        text: "",
        video: "media/GBA_Luigi_Circuit/sc2.mp4",
        frame: "media/GBA_Luigi_Circuit/sc2.jpg",
      },
      {
        text: "",
        video: "media/GBA_Luigi_Circuit/sc3.mp4",
        frame: "media/GBA_Luigi_Circuit/sc3.jpg",
      },
      {
        text: "Skips a double item but you can still grab 1 box when taking it.",
        video: "media/GBA_Luigi_Circuit/sc4.mp4",
        frame: "media/GBA_Luigi_Circuit/sc4.jpg",
      },
      {
        text: "",
        video: "media/GBA_Luigi_Circuit/sc5.mp4",
        frame: "media/GBA_Luigi_Circuit/sc5.jpg",
      },
    ],
    billSpots: [
      {
        text: "This is a bullet shortcut. You have to do a hop over the water and (before hitting it for obvious reasons) activate your bill. But if you don't activate it at the right time, the bill will take the main road. If you use it in last it usually takes you to the finish line",
        video: "media/GBA_Luigi_Circuit/billSpot1.mp4",
        frame: "media/GBA_Luigi_Circuit/billSpot1.jpg",
      },
    ],
  },
  "N64 Choco Mountain": {
    trackImage: "media/N64_Choco_Mountain/image.png",
    trackType: "Runner/Bagger",
    strategyDescription:
      "Running: Few cuts on this track and there's also a cannon + a teleporter so you have some possibilities to dodge a blue shell if it happens on a good moment. Try to take the best lines and back people if you have 2 protections. No strats at all on this track, it's all running and cuts barely save time making it a good track to run, also an easy one for anyone who can rd without difficulties. Just be careful of the rocks falling from the mountain as the original version and it should be fine.\n\nBagging: You can try bagging on this map but don't stay too far because it can be hard to come back as well, moreover if there's no blue shell(s) you have to expect dodging if you want to have a chance to come back 1st. If there's a shock you can be in a very good situation depending on when it happens though.",
    shortcuts: [
      {
        text: "",
        video: "media/N64_Choco_Mountain/sc1.mp4",
        frame: "media/N64_Choco_Mountain/sc1.jpg",
      },
      {
        text: "",
        video: "media/N64_Choco_Mountain/sc2.mp4",
        frame: "media/N64_Choco_Mountain/sc2.jpg",
      },
    ],
    billSpots: [
      {
        text: "+1 Second\n\nUse before the cannon. Takes you to the end",
        video: "media/N64_Choco_Mountain/billSpot1.mp4",
        frame: "media/N64_Choco_Mountain/billSpot1.jpg",
      }
    ],
  },
  "MK5(O) Haunted Village": {
    trackImage: "media/MK5(O)_Haunted_Village/image.png",
    trackType: "Runner",
    strategyDescription:
      "There's a lot of cannons and strats on this track, making it a running track. It's almost impossible to come back on it while bagging so you should always run it, shocks are uncommon on this track and if it happens they generally will at the end so if you ran the whole track you should be fine, also almost impossible to take a blue shell on it unless you get a very unlucky timing because you can dodge it in like 70% of the track.",
    shortcuts: [
      {
        text: "Thanks to the boost panels you can cut a bit of off-road and gain time.",
        video: "media/MK5(O)_Haunted_Village/nisc1.mp4",
        frame: "media/MK5(O)_Haunted_Village/nisc1.jpg",
      },
      {
        text: "Thanks to the boost panels you can cut a bit of off-road and gain time.",
        video: "media/MK5(O)_Haunted_Village/nisc2.mp4",
        frame: "media/MK5(O)_Haunted_Village/nisc2.jpg",
      },
      {
        text: "Thanks to the boost panels you can... cut a bit of off-road and gain time",
        video: "media/MK5(O)_Haunted_Village/nisc3.mp4",
        frame: "media/MK5(O)_Haunted_Village/nisc3.jpg",
      },
      {
        text: "thanks to the boost panels you can cut a bit of off-road and gain time... Release a smt at the end and hop out to not get slowed down by the off-road",
        video: "media/MK5(O)_Haunted_Village/nisc4.mp4",
        frame: "media/MK5(O)_Haunted_Village/nisc4.jpg",
      },
      {
        text: "",
        video: "media/MK5(O)_Haunted_Village/sc1.mp4",
        frame: "media/MK5(O)_Haunted_Village/sc1.jpg",
      },
      {
        text: "",
        video: "media/MK5(O)_Haunted_Village/sc2.mp4",
        frame: "media/MK5(O)_Haunted_Village/sc2.jpg",
      },
      {
        text: "",
        video: "media/MK5(O)_Haunted_Village/sc3.mp4",
        frame: "media/MK5(O)_Haunted_Village/sc3.jpg",
      },
      {
        text: "",
        video: "media/MK5(O)_Haunted_Village/sc4.mp4",
        frame: "media/MK5(O)_Haunted_Village/sc4.jpg",
      },
    ],
    billSpots: [],
  },
  "Wii U Thwomp Ruins": {
    trackImage: "media/WiiU_Thwomp_Ruins/image.png",
    trackType: "Runner/Bagger",
    strategyDescription:
      "Running: By doing the shroomless cuts and taking tight lines you can run this track but be careful of the baggers because there's often blue(s) and shock(s) on this track.\n\nBagging: One powerful cut at the beginning that can be very good to come back for lap 2/3. If you want to bag you could go to the 1st purple path because there is a double item box at the end of it therefore giving you strong items. You can try to predict a shock or even bag for it in this map because it's powerful, don't stay too far behind though because the runner can easily fly away and get a huge lead as well.",
    shortcuts: [
      {
        text: "Hard to take it shroomless, you have to get a smt and release it at the last moment to cut as much as you can and get to the ramp without hitting off-road (even if you fail it remains faster than going in the main road anyway). You should try to train it in time trial if you experience difficulties doing it properly.",
        video: "media/WiiU_Thwomp_Ruins/nisc1.mp4",
        frame: "media/WiiU_Thwomp_Ruins/nisc1.jpg",
      },
      {
        text: "Just jump",
        video: "media/WiiU_Thwomp_Ruins/nisc2.mp4",
        frame: "media/WiiU_Thwomp_Ruins/nisc2.jpg",
      },
      {
        text: "",
        video: "media/WiiU_Thwomp_Ruins/sc1.mp4",
        frame: "media/WiiU_Thwomp_Ruins/sc1.jpg",
      },
    ],
    billSpots: [
      {
        text: "+2 Seconds\n\nThe spot where you use it is precise and if you use it a bit later it may not work",
        video: "media/WiiU_Thwomp_Ruins/billSpot1.mp4",
        frame: "media/WiiU_Thwomp_Ruins/billSpot1.jpg",
      }
    ],
  },
  "Tour Sydney Sprint": {
    trackImage: "media/Tour_Sydney_Sprint/image.png",
    trackType: "Runner/Bagger",
    strategyDescription:
      "Running: When you start in 1st you can try running this map, be careful of shocks/blues because they're quite common due to the size of the map. Except lap 2, there are no cuts on the track so you have chances to increase your lead by backing your items. There are also cannons on this map giving you multiple opportunities to blue dodge.\n\nBagging: It's good to start bagging at the 1st item set of the second lap because there are multiple cuts in this lap that can gives you a good lead and opportunities to come back with good items or even to dodge a shock. Many shocks happen between mid and end lap 2.",
    shortcuts: [
      {
        text: "",
        video: "media/Tour_Sydney_Sprint/sc1.mp4",
        frame: "media/Tour_Sydney_Sprint/sc1.jpg",
      },
      {
        text: "",
        video: "media/Tour_Sydney_Sprint/sc2.mp4",
        frame: "media/Tour_Sydney_Sprint/sc2.jpg",
      },
      {
        text: "",
        video: "media/Tour_Sydney_Sprint/sc3.mp4",
        frame: "media/Tour_Sydney_Sprint/sc3.jpg",
      },
      {
        text: "",
        video: "media/Tour_Sydney_Sprint/sc4.mp4",
        frame: "media/Tour_Sydney_Sprint/sc4.jpg",
      },
    ],
    billSpots: [
      {
        text: "+2 Seconds\n\n(there's probably a better way to take this one but I didn't find it)",
        video: "media/Tour_Sydney_Sprint/billSpot1.mp4",
        frame: "media/Tour_Sydney_Sprint/billSpot1.jpg",
      },
      {
        text: "+2.5 Seconds\n\nUsing the same bridge, just on lap 3 and not 2",
        video: "media/Tour_Sydney_Sprint/billSpot2.mp4",
        frame: "media/Tour_Sydney_Sprint/billSpot2.jpg",
      }
    ],
  },
  "Wii U Ice Ice Outpost": {
    trackImage: "media/WiiU_Ice_Ice_Outpost/image.png",
    trackType: "Runner",
    strategyDescription:
      "This map is one of the toughest in ctp so if you master the shroomless cuts, it will give you a strong chance of winning. Few people know how to take all the shroomless cuts well because they are hard, so taking risks is highly rewarded if you can take the cuts properly. I suggest you to train them in time trial. There are also 2 cannons and more than half of blue shells are launched at this moment, making you able to dodge them. Thus you should always run this map and it's one of the best picks if you're 1st.\n\nBagging: It is a disadvantage to start in bottom placements in this track but if it happens, you haven't lost yet. There are 2 paths where you can try to bag a bit to get a double item box and come back. You shouldn't bag any more than that though because it's super hard to come back on this track as there are no off road shortcuts.",
    shortcuts: [
      {
        text: "",
        video: "media/WiiU_Ice_Ice_Outpost/nisc1.mp4",
        frame: "media/WiiU_Ice_Ice_Outpost/nisc1.jpg",
      },
      {
        text: "",
        video: "media/WiiU_Ice_Ice_Outpost/nisc2.mp4",
        frame: "media/WiiU_Ice_Ice_Outpost/nisc2.jpg",
      },
      {
        text: "",
        video: "media/WiiU_Ice_Ice_Outpost/nisc3.mp4",
        frame: "media/WiiU_Ice_Ice_Outpost/nisc3.jpg",
      },
    ],
    billSpots: [],
  },
  "MK(X) Bowser's Factory": {
    trackImage: "media/MK(X)_Bowser's_Factory/image.png",
    trackType: "Runner/Bagger",
    strategyDescription:
      "Running: If you're in the 1st place you can decide to run instantly, it's a map where you can get a big lead easily if you run it well and take tight lines. Many people hit the firebars and other decors so if you know the map well enough it is a good decision for you to run it. Be careful because it's still rare to get a blueless run on this track.\n\nBagging: If you bag you should start it at the beginning behind the 1st item set and come back in the next laps. You can dodge a shock and the 1st cut is op, especially on lap 3 when everyone is close, having mushrooms there is needed. You can also take the alternative path at the end of lap 1/2 to bag a bit. Many boxes on this track so you bag well and come back properly.",
    shortcuts: [
      {
        text: "",
        video: "media/MK(X)_Bowser's_Factory/sc1.mp4",
        frame: "media/MK(X)_Bowser's_Factory/sc1.jpg",
      },
      {
        text: "",
        video: "media/MK(X)_Bowser's_Factory/sc2.mp4",
        frame: "media/MK(X)_Bowser's_Factory/sc2.jpg",
      },
    ],
    billSpots: [],
  },
  "3DS Rainbow Road": {
    trackImage: "media/3DS_Rainbow_Road/image.png",
    trackType: "Runner",
    strategyDescription:
      "This is a section track and there aren't any cuts, there are a lot of boosts in this track as well making it a running track because you can increase your lead quickly enough. It is very hard to come back on this track so I suggest you to never bag it. Instead, run it and take the tightest lines you can and don't forget to take the boost pannels and the shroomless cut.",
    shortcuts: [
      {
        text: "One of the hardest (if not the hardest) shroomless cut of ctp. Slow down once you land after the cannon and turn back to the cut, then release a smt and jump to the other side. If you do it well enough you will be able to do it without falling, making you gain a lot of time. And even if you fail it and fall, you will respawn on the other edge and still gain time compared to the main route.",
        video: "media/3DS_Rainbow_Road/nisc1.mp4",
        frame: "media/3DS_Rainbow_Road/nisc1.jpg",
      },
    ],
    billSpots: [],
  },
};

document.getElementById("results").style.display = "none";
document.querySelector(".strategy").style.display = "none";
document.querySelector(".shortcuts").style.display = "none";
document.querySelector(".bill-spots").style.display = "none";

let currentTrack;
const suggestionList = document.getElementById("suggestionList");

document.getElementById("trackSearch").addEventListener("input", function () {
  if (this.value != "") {
    const query = this.value.toLowerCase();
    const suggestions = getTrackSuggestions(query);
    displaySuggestions(suggestions);
  } else {
    displaySuggestions("");
  }
});

function normalizeTrackName(trackName) {
  return trackName.trim().toLowerCase();
}

function matchesInOrder(query, trackName) {
  const queryLetters = query.split(" ").join("");
  let trackIndex = 0;
  for (let char of queryLetters) {
    trackIndex = trackName.indexOf(char, trackIndex);
    if (trackIndex === -1) return false;
    trackIndex++;
  }
  return true;
}

function getTrackSuggestions(query) {
  const normalizedTracks = Object.keys(tracks).map((track) => ({
    original: track,
    normalized: normalizeTrackName(track),
  }));

  const exactMatches = normalizedTracks
    .filter((track) => track.normalized.includes(query))
    .map((track) => track.original);

  const orderMatches = normalizedTracks
    .filter(
      (track) =>
        matchesInOrder(query, track.normalized) &&
        !exactMatches.includes(track.original)
    )
    .map((track) => track.original);

  return [...exactMatches, ...orderMatches];
}

function displaySuggestions(suggestions) {
  const suggestionList = document.getElementById("suggestionList");
  suggestionList.innerHTML = "";
  if (suggestions.length === 0) {
    suggestionList.style.display = "none";
  } else {
    suggestions.forEach((suggestion) => {
      const li = document.createElement("li");
      li.textContent = suggestion;
      li.style.padding = "10px";
      li.style.cursor = "pointer";
      li.onclick = () => selectTrack(suggestion);
      suggestionList.appendChild(li);
    });
    suggestionList.style.display = "block";
  }
}
displaySuggestions("");

function selectTrack(trackName) {
  if (tracks[trackName]) {
    currentTrack = trackName;
    showContent("strategy", currentTrack);
    document.getElementById("trackSearch").value = trackName;
    suggestionList.style.display = "none";
  }
}

const strategyBtn = document.getElementById("strategyBtn");
const shortcutsBtn = document.getElementById("shortcutsBtn");
const billSpotsBtn = document.getElementById("billSpotsBtn");

let currentContent = "strategy";

strategyBtn.addEventListener("click", () => {
  currentContent = "strategy";
  showContent(currentContent, currentTrack);
});

shortcutsBtn.addEventListener("click", () => {
  currentContent = "shortcuts";
  showContent(currentContent, currentTrack);
});

billSpotsBtn.addEventListener("click", () => {
  currentContent = "billSpots";
  showContent(currentContent, currentTrack);
});

function showContent(type, trackName) {
  document.querySelector(".strategy").style.display = "none";
  document.querySelector(".shortcuts").style.display = "none";
  document.querySelector(".bill-spots").style.display = "none";
  if (tracks[trackName]) {
    const trackInfo = tracks[trackName];

    document.querySelector(".strategy-description").innerHTML =
      trackInfo.strategyDescription.replace(/\n/g, "<br>");
    const trackNameElement = document.querySelector(".track-name");
    trackNameElement.textContent = trackName;
    trackNameElement.style.display = "block";

    const trackImageElement = document.querySelector(".track-image");
    trackImageElement.src = trackInfo.trackImage;
    trackImageElement.style.display = "block";

    const trackTypeElement = document.querySelector(".track-type");
    trackTypeElement.innerHTML = `<b>Track Type</b> : ${trackInfo.trackType}`;
    trackNameElement.style.display = "block";

    const shortcutsDiv = document.querySelector(".shortcuts");
    const billSpotsDiv = document.querySelector(".bill-spots");

    shortcutsDiv.innerHTML = "";
    billSpotsDiv.innerHTML = "";

    if (type === "shortcuts" && Array.isArray(trackInfo.shortcuts)) {
      trackInfo.shortcuts.forEach((shortcut) => {
        const panel = document.createElement("div");
        panel.classList.add("panel");

        if (shortcut.text != "") {
          const text = document.createElement("p");
          text.innerHTML = shortcut.text.replace(/\n/g, "<br>");
          text.style.textAlign = "center";
          text.style.marginBottom = "15px";
          text.style.marginTop = "5px";
          panel.appendChild(text);
        }

        const img = document.createElement("img");
        img.src = shortcut.frame;
        img.className = "panel-image";
        img.style.width = "100%";
        img.style.cursor = "pointer";

        const video = document.createElement("video");
        video.src = shortcut.video;
        video.preload = "auto";
        img.onclick = () => showVideo(video, img);

        panel.appendChild(img);
        shortcutsDiv.appendChild(panel);
      });
    }

    if (type === "billSpots" && Array.isArray(trackInfo.billSpots)) {
      trackInfo.billSpots.forEach((spot) => {
        const panel = document.createElement("div");
        panel.classList.add("panel");

        if (spot.text != "") {
          const text = document.createElement("p");
          text.innerHTML = spot.text.replace(/\n/g, "<br>");
          text.style.textAlign = "center";
          text.style.marginBottom = "15px";
          text.style.marginTop = "5px";
          panel.appendChild(text);
        }

        const img = document.createElement("img");
        img.src = spot.frame;
        img.className = "panel-image";
        img.style.width = "100%";
        img.style.cursor = "pointer";

        const video = document.createElement("video");
        video.src = spot.video;
        video.preload = "auto";
        img.onclick = () => showVideo(video, img);

        panel.appendChild(img);
        billSpotsDiv.appendChild(panel);
      });
    }

    document.getElementById("results").style.display = "block";

    switch (type) {
      case "strategy":
        document.querySelector(".strategy").style.display = "block";
        break;
      case "shortcuts":
        shortcutsDiv.style.display = "block";
        break;
      case "billSpots":
        billSpotsDiv.style.display = "block";
        break;
    }
  }
}

function showVideo(video, imgElement) {
  video.controls = false;
  video.style.width = "100%";
  video.style.height = imgElement.clientHeight + "px";

  imgElement.style.display = "none";

  const panel = imgElement.parentElement;
  panel.appendChild(video);
  video.currentTime = 0;
  video.play();

  video.addEventListener("ended", () => {
    revertToImage(imgElement, panel);
  });

  video.addEventListener("click", () => {
    revertToImage(imgElement, panel);
  });
}

function revertToImage(imgElement, panel) {
  const video = panel.querySelector("video");
  if (video) {
    video.remove();
  }
  imgElement.style.display = "block";
}

const helpPanel = document.getElementById("helpPanel");
const overlay = document.getElementById("overlay");

document.getElementById("helpIcon").addEventListener("click", function () {
  helpPanel.style.display = "block";
  overlay.style.display = "block";
});

document.getElementById("hideHelpBtn").addEventListener("click", function () {
  helpPanel.style.display = "none";
  overlay.style.display = "none";
});
